<html>
<html lang="en">
    <head>
        <script src='https://d3js.org/d3.v7.min.js'></script>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    </head> 

<nav class="navbar navbar-light" style="background-color: #44a0ec8e;">
    <a class="navbar-brand" href="../index.html" style="color: white">DF Lab 1</a>
    
      <span class="navbar-toggler-icon"></span>
    </button>

  </nav>




<body>
    
 

  </div>

    
  <style>
    svg rect {
     fill: blue;
    }
    svg text {
     fill:white;
     font: 10px sans-serif;
     text-anchor: end;
    }
    </style>
    <script>
    var width = 200;
    var scaleFactor = 10;
    var barHeight = 20;
    var  margin = { top: 10, right: 30, bottom: 50, left: 20 };
   


     let heartfailurecsv = 'https://raw.githubusercontent.com/akmand/datasets/master/heart_failure.csv';

count_overFifty =0        
count_arr2 = [{name : '1-30: ', count: 0},
              {name : '31-40: ', count: 0},
              {name : '41-60: ', count: 0},
              {name : '61-100: ', count: 0}]
csv_data = []
d3.csv(heartfailurecsv, function(data) {
    csv_data.push(data)
patient_age = data.age

if (patient_age>50){count_overFifty=count_overFifty+1}

if(patient_age > 0 && patient_age <=30){ count_arr2[0].count= count_arr2[0].count+=1}
else if(patient_age > 30 && patient_age <=40){count_arr2[1].count+=1}
else if(patient_age > 40 && patient_age <=60){count_arr2[2].count+=1}
else if(patient_age > 60 && patient_age <=100){count_arr2[3].count+=1}

}).then(()=>{  
data = count_arr2
    // var graph = d3.select("body")
    //  .append("svg")
    //  .attr("width", width*2 + margin.right + margin.left)
    //  .attr("height", barHeight * data.length + margin.top + margin.bottom)
    //  .style("border", '5px solid grey');
    // var bar = graph.selectAll("g")
    //  .data(data)
    //  .enter()
    //  .append("g")
    //  .attr("transform", function(d, i) {
    //  return "translate(0," + i * barHeight + ")";
    //  });
    // bar.append("rect")
    //  .attr("width", function(d) {
    //  return d.count * scaleFactor;
    //  })
    //  .attr("height", barHeight - 1);
    // bar.append("text")
    //  .attr("x", function(d) { return (d.count*scaleFactor); })
    //  .attr("y", barHeight / 2)
    //  .attr("dy", ".35em")
    //  .text(function(d) { return d.name; });

     var info = d3.select("body")
     .append("svg")
     .attr("width", '100vw' )
     .attr("height", 150 )

     info.append("rect")
        .attr("x", 45 )
        .attr("y", 50)
        .attr("width",30)
        .attr("height", 20)
        .style("fill", 'red')
        .append('text')    
       
        info.append("rect")
        .attr("x", 235 )
        .attr("y", 50)
        .attr("width",30)
        .attr("height", 20)
        .attr("fill", 'red')    

        info.append('text').text('Below the age of 65')
                .attr('x', 100)
                .attr('y', 85)
                .style('fill', 'black')

        info.append('text').text('Over the age of 65')
                .attr('x', 290)
                .attr('y', 85)
                .style('fill', 'black')            
        
        info.append('text').text('Legend')
                .attr('x', 170)
                .attr('y', 30)
                .style('fill', 'black')            
    
    
     var graph1 = d3.select("body")
     .append("svg")
     .attr("width", '100vw')
     .attr("height", barHeight * csv_data.length)
     .style("border", '5px solid grey');;
    var bar = graph1.selectAll("g")
     .data(csv_data)
     .enter()
     .append("g")
     .attr("transform", function(d, i) {
     return "translate(0," + i * barHeight + ")";
     });
     
    bar.append("rect")
     .attr("width", function(d) {
     return d.age * scaleFactor;
     })
     .attr("height", barHeight - 1)
     .style("fill", function(d){ return (d.age>65? "#fc2003":"blue"); });
    bar.append("text")
     .attr("x", function(d) { return (d.age*scaleFactor); })
     .attr("y", barHeight / 2)
     .attr("dy", ".35em")
     .text(function(d) { return d.age; });

                });


          
    </script>

</body>
</html>